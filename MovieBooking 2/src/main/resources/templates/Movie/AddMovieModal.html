<!-- Add Movie Modal -->
<div class="modal fade" id="addMovieModal" tabindex="-1" aria-labelledby="addMovieModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="addMovieModalLabel">Add New Movie</h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="text-center mb-3">
                    <img id="movieThumbnail" src="https://upload.wikimedia.org/wikipedia/commons/thumb/6/65/No-Image-Placeholder.svg/1665px-No-Image-Placeholder.svg.png" alt="Movie Thumbnail" class="movie-thumbnail">
                </div>
                <form id="addMovieForm" th:action="@{/movies/add}" method="post" enctype="multipart/form-data">
                    <div class="mb-3">
                        <label for="movieNameENG" class="form-label required-field">Movie name (ENG):</label>
                        <input type="text" class="form-control" id="movieNameENG" name="nameEnglish" required placeholder="Enter movie name in English">
                        <div class="invalid-feedback">Please enter the movie name in English.</div>
                    </div>
                    <div class="mb-3">
                        <label for="movieNameVN" class="form-label required-field">Movie name (VN):</label>
                        <input type="text" class="form-control" id="movieNameVN" name="nameVN" required placeholder="Enter movie name in Vietnamese">
                        <div class="invalid-feedback">Please enter the movie name in Vietnamese.</div>
                    </div>
                    <div class="mb-3">
                        <label for="fromDate" class="form-label required-field">From date:</label>
                        <input type="date" class="form-control" id="fromDate" name="fromDate" required>
                        <div class="invalid-feedback">Please select a valid from date.</div>
                    </div>
                    <div class="mb-3">
                        <label for="toDate" class="form-label required-field">To date:</label>
                        <input type="date" class="form-control" id="toDate" name="toDate" required>
                        <div class="invalid-feedback">Please select a valid to date.</div>
                    </div>
                    <div class="mb-3">
                        <label for="actor" class="form-label required-field">Actor:</label>
                        <input type="text" class="form-control" id="actor" name="actor" required placeholder="Enter actor names">
                        <div class="invalid-feedback">Please enter the actor's name.</div>
                    </div>
                    <div class="mb-3">
                        <label for="productionCompany" class="form-label required-field">Movie Production Company:</label>
                        <input type="text" class="form-control" id="productionCompany" name="productionCompany" required placeholder="Enter production company name">
                        <div class="invalid-feedback">Please enter the production company.</div>
                    </div>
                    <div class="mb-3">
                        <label for="director" class="form-label required-field">Director:</label>
                        <input type="text" class="form-control" id="director" name="director" required placeholder="Enter director name">
                        <div class="invalid-feedback">Please enter the director's name.</div>
                    </div>
                    <div class="mb-3">
                        <label for="duration" class="form-label required-field">Duration:</label>
                        <input type="number" class="form-control" id="duration" name="duration" required placeholder="Enter duration in minutes">
                        <div class="invalid-feedback">Please enter the movie duration.</div>
                    </div>
                    <div class="mb-3">
                        <label for="version" class="form-label required-field">Version:</label>
                        <input type="text" class="form-control" id="version" name="version" required placeholder="Enter movie version">
                        <div class="invalid-feedback">Please enter the movie version.</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label required-field">Type:</label>
                        <div id="movieTypes">
                            <div class="form-check" th:each="type : ${types}">
                                <input class="form-check-input" type="checkbox" th:id="${'type-' + type.typeId}" name="movieTypes" th:value="${type.typeId}">
                                <label class="form-check-label" th:for="${'type-' + type.typeId}" th:text="${type.typeName}"></label>
                            </div>
                        </div>
                        <div class="invalid-feedback">Please select at least one movie type.</div>
                    </div>
                    <div class="mb-3">
                        <label for="cinemaRoom" class="form-label required-field">Cinema room:</label>
                        <select id="cinemaRoom" name="cinemaRoom" class="form-select" required>
                            <option value="" selected disabled>Choose a cinema room</option>
                            <option th:each="room : ${cinemaRooms}" th:value="${room.cinemaRoomId}" th:text="${room.cinemaName}"></option>
                        </select>
                        <div class="invalid-feedback">Please select a cinema room.</div>
                    </div>
                    <div class="mb-3">
                        <label class="form-label required-field">Schedule:</label>
                        <div id="schedules">
                            <div th:each="schedule : ${schedules}" class="form-check">
                                <input type="checkbox" th:id="'schedule' + ${schedule.scheduleId}" th:value="${schedule.scheduleId}" name="schedules" class="form-check-input">
                                <label th:for="'schedule' + ${schedule.scheduleId}" th:text="${schedule.scheduleTime}" class="form-check-label"></label>
                            </div>
                        </div>
                        <div class="invalid-feedback">Please select at least one schedule.</div>
                    </div>
                    <div class="mb-3">
                        <label for="content" class="form-label required-field">Content:</label>
                        <textarea class="form-control" id="content" name="content" rows="3" required placeholder="Enter movie description"></textarea>
                        <div class="invalid-feedback">Please enter the movie content.</div>
                    </div>
                    <div class="mb-3">
                        <label for="largeImage" class="form-label">Image:</label>
                        <div class="input-group">
                            <input type="file" class="form-control" id="largeImage" name="imageFile" accept="image/*" style="display: none;">
                            <input type="text" class="form-control" id="fileName" readonly value="Không có tệp nào được chọn">
                            <button class="btn btn-outline-secondary" type="button" id="chooseFileBtn">Chọn tệp</button>
                        </div>
                    </div>
                    <div class="modal-footer">
                        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
                        <button type="submit" class="btn btn-primary">Add Movie</button>
                    </div>
                </form>
            </div>
        </div>
    </div>
</div>

<style>
    .required-field::after {
        content: " *";
        color: red;
    }

    .custom-file-input {
        position: relative;
        display: inline-block;
        width: 100%;
    }

    .file-input {
        position: absolute;
        left: 0;
        top: 0;
        opacity: 0;
        width: 100%;
        height: 100%;
        cursor: pointer;
    }

    .file-input-label {
        display: flex;
        align-items: center;
        padding: 6px 12px;
        background-color: #fff;
        border: 1px solid #ced4da;
        border-radius: 4px;
    }

    .choose-file-btn {
        padding: 6px 12px;
        background-color: #e9ecef;
        border: 1px solid #ced4da;
        border-radius: 4px;
        margin-right: 10px;
    }

    .file-name {
        flex-grow: 1;
        white-space: nowrap;
        overflow: hidden;
        text-overflow: ellipsis;
    }
</style>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const fileInput = document.getElementById('largeImage');
        const fileName = document.getElementById('fileName');
        const chooseFileBtn = document.getElementById('chooseFileBtn');

        chooseFileBtn.addEventListener('click', function() {
            fileInput.click();
        });

        fileInput.addEventListener('change', function(event) {
            if (event.target.files.length > 0) {
                let simpleName = event.target.files[0].name.split('\\').pop().split('/').pop();
                fileName.value = simpleName;
            } else {
                fileName.value = 'Không có tệp nào được chọn';
            }
        });
    });
</script>